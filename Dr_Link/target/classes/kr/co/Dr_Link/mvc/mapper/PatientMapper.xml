<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="patient">
  
  <!-- 김다유 : 처방기록 -->
  <select id="treatmentRecord" parameterType="treatmentRecordDTO" resultType="treatmentRecordDTO">
  select * from treatment_record where patient_num='3'
  </select>
  
  
  
    <!-- 
create table dl_user (      
    patient_num number(10) constraint dl_patient_num_pk primary key,
    p_id varchar2(20) null,
    p_pwd varchar2(20) null,
    p_name varchar2(10) null,
	p_birth varchar2(20) null,
    p_phone char(13) null,
    p_zipcode VARCHAR2(20) null,
	p_address1 varchar2(200) null,
	p_address2 varchar2(20) null,
    p_email varchar2(30) null,
    p_blood varchar2(10) null
);

create sequence dl_patient_num_pk increment by 1 start with 1;
 -->
 
 
  	<!-- 회원가입 -->
	<insert id="add" parameterType="patientDTO">
		insert into dl_user values(dl_patient_num_pk.nextval, #{p_id}, #{p_pwd}, #{p_name}, #{p_birth}, #{p_phone}, #{p_zipcode}, #{p_address1}, #{p_address2}, #{p_email}, #{p_blood})
	</insert>
	
	<!-- 로그인 -->
	<select id="loginchk" parameterType="patientDTO" resultType="patientDTO">
		select p_id, p_pwd from dl_user where p_id=#{p_id} and p_pwd=#{p_pwd}
	</select>

  
	<!-- 아이디 중복 검사 -->
	<select id="idCheck" parameterType="String" resultType="int">
		select count(*) from dl_user where p_id = #{p_id}
	</select>

  
	<!-- 아이디 중복 검사 -->
	<select id="check_id" parameterType="String" resultType="int">
		select count(*) from dl_user where p_id = #{p_id}
	</select>
	
	
	<!-- 아이디 찾기 -->
	<select id="find_id" parameterType="String" resultType="String">
		select p_id from dl_user where p_email = #{email}
	</select>


	<!-- 비밀번호 변경 -->
	<update id="update_pw" parameterType="patientDTO">
		update dl_user set p_pwd = #{pw} where p_id = #{id}
	</update>

	<!-- 이메일 매칭용 -->
	<select id="emailCheck" parameterType="String" resultType="patientDTO">
		select * from dl_user where p_id = #{id}
	</select>
	
  </mapper>